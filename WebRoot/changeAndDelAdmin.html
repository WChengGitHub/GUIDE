<!DOCTYPE html>
<html>
<head>
<title>changeAndDelAdmin</title>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="HandheldFriendly" content="true">
<link href="./css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="./css/font-awesome.min.css">
<link rel="stylesheet" href="./css/changeAndDelAdmin.css">
<link rel="stylesheet" href="css/pagination.css" />
<script src="./css/jquery.js"></script>
<script src="./css/bootstrap.min.js"></script>
<script type="text/javascript" src="./css/jquery.pagination.js"></script>
<script>
  var Account;
	var Privilege;
	function getCookie() {
		var strCookie = document.cookie;
		var arrCookie = strCookie.split(";");
		for (var i = 0; i < arrCookie.length; i++) {
			var arr = arrCookie[i].split("=");
			arr[0] = $.trim(arr[0]);
			if ("Account" == arr[0]) {
				Account = arr[1];

			}
			if ("Privilege" == arr[0]) {

				Privilege = arr[1];
			}
		}
	}
	function setCookie() {
		var now = new Date();
		now.setTime(now.getTime() + 5 * 60 * 1000);
		document.cookie = "Privilege=a;expires=" + now.toGMTString();
		document.cookie = "Account=Hello;expires=" + now.toGMTString();
	}
	function judgeAdmin() {
		getCookie();
		if (Account == null || Privilege == null || Account == undefined
				|| Privilege == undefined) {
			
			window.open("Home.html", "_self");
		} else {
			changeDisplay();
		}
	}
	function changeDisplay() {
		document.getElementById("AdminName").innerHTML = Account;

		if (Privilege != "a") {
            window.open("Home.html", "_self");
			
		}
	}
	function getAdminRecordList() {

		$
				.ajax({
					type : 'post',
					url : "getAdminRecordList",
					contentType : 'application/json;charset=utf-8',
					dataType : 'json',
					success : function(data) {

						var data = data;
						$(function() {

							var length = data.length;
							$("#Pagination1").pagination(length, {
								items_per_page : 10,
								callback : pageselectCallback
							});

							function pageselectCallback(page_index, jq) {
								var items_per_page = 10;
								var max_elem = Math.min((page_index + 1)
										* items_per_page, length);

								$("#allAdmin").html("");//html() 方法返回或设置被选元素的内容 (inner HTML)。
								for (var i = page_index * items_per_page; i < max_elem; i++) {
									
										$("#allAdmin")
												.append(
														'<tr><td>'+data[i].aid+'</td><td>'+data[i].account+'</td><td>'+data[i].privilege+'</td><td>'+data[i].email+'</td><td>'+data[i].createTime+'<button onclick=setAdminDelStatus("'+data[i].email+'","'+data[i].aid+'","'+data[i].account+'") class="btn btn-primary pull-right btn-xs text-center" type="button"><span class="fa fa-fw  fa-close fa-lg "></span></button><button class="btn btn-success btn-xs pull-right text-center" type="button" style="margin-right:10px;"><span class="fa fa-fw fa-edit fa-lg "></span></button></td></tr>');

								}
								return false;
							}
						});
					},
					error : function() {
						return;
					}
				});
	}
	function setAdminDelStatus(Email,Aid,account)
	{
		alert(Email);
		alert(Aid);
		alert(account);
		$
		.ajax({
			type : 'post',
			url : "setAdminDelStatus?Email="+Email+"&Aid="+Aid+"&Account="+account,
			contentType : 'application/json;charset=utf-8',
			dataType : 'json',
			success : function(data) {
            
				alert("成功");
				getAdminRecordList();
			},
			error : function() {
				return;
			}
		});
	}
	setCookie();
</script>
</head>
<body>
  <div id="header" style="background-color:#222;width:100%">
		<div class="navbar navbar-default navbar-inverse " role="navigation">
			<div class="navbar-header header" style="display:inline-block;">
				<a href="##" class="navbar-brand" id="Admin">超级管理员</a>
			</div>
			<ul class="nav  headerRight pull-right top-nav">
				<li><a href="##"><span class="fa fa-fw fa-user fa-lg"></span><span
						id="AdminName"></span></a></li>
			</ul>
		</div>
	</div>
	<div  id="content" class="col-lg-12">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">审核与景区管理员</h3>
			</div>
			<div class="panel-body">
				<div id="Pagination1" class="pagination"></div>
				<div class="table-responsive myTable">
					<!--响应式表格-->

					<table class="table table-bordered table-hover table-striped">

						<!--带边框表格,斑马线表格-->
						<thead class="myThead">
							<tr>
								<th>管理员ID</th>
								<th>管理员名字</th>
								<th>权限</th>
								<th>邮箱</th>
								<th>创建时间</th>
							</tr>
						</thead>
						<tbody id="allAdmin">
                            
						</tbody>

					</table>
				</div>

			</div>
		</div>

	</div>
	<script>
	judgeAdmin();
	getAdminRecordList();
	</script>
</body>
</html>